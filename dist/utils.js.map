{"version":3,"sources":["../src/utils.js"],"names":["appEvents","hostname","window","location","postgRestHost","influxHost","post","url","line","Promise","resolve","reject","xhr","XMLHttpRequest","open","onreadystatechange","handleResponse","setRequestHeader","onerror","e","send","readyState","status","responseText","update","deleteMethod","statusText","get","res","JSON","parse","alert","type","title","msg","emit","showModal","html","data","src","modalClass","model","writeProductionLine","postgresUrl","info","site","area","writeLine","category","reason","parent","getReasons","node","allData","reasons","filter","d","category_id","reason_id","reduce","arr","push","Array","from","Set"],"mappings":"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","file":"utils.js","sourcesContent":["import { appEvents } from 'app/core/core'\n\nconst hostname = window.location.hostname\nexport const postgRestHost = 'http://' + hostname + ':5436/'\nexport const influxHost = 'http://' + hostname + ':8086/'\n\nexport const post = (url, line) => {\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest()\n    xhr.open('POST', url)\n    xhr.onreadystatechange = handleResponse\n    xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n    xhr.onerror = e => reject(e)\n    xhr.send(line)\n\n    function handleResponse () {\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200) {\n          // console.log('200');\n          resolve(xhr.responseText)\n        } else if (xhr.status === 204) {\n          // console.log('204');\n          resolve(xhr.responseText)\n        } else if (xhr.status === 201) {\n          resolve(xhr.responseText)\n        } else {\n          reject(xhr.responseText)\n        }\n      }\n    }\n  })\n}\n\nexport const update = (url, line) => {\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest()\n    xhr.open('PATCH', url)\n    xhr.onreadystatechange = handleResponse\n    xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n    xhr.onerror = e => reject(e)\n    xhr.send(line)\n\n    function handleResponse () {\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200) {\n          // console.log('200');\n          resolve(xhr.responseText)\n        } else if (xhr.status === 204) {\n          // console.log('204');\n          resolve(xhr.responseText)\n        } else if (xhr.status === 201) {\n          resolve(xhr.responseText)\n        } else {\n          reject(xhr.responseText)\n        }\n      }\n    }\n  })\n}\n\nexport const deleteMethod = (url) => {\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest()\n    xhr.open('DELETE', url)\n    xhr.onreadystatechange = handleResponse\n    xhr.onerror = e => reject(e)\n    xhr.send()\n\n    function handleResponse () {\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200) {\n          // console.log('200');\n          resolve(xhr.responseText)\n        } else if (xhr.status === 204) {\n          // console.log('204');\n          resolve(xhr.responseText)\n        } else {\n          reject(this.statusText)\n        }\n      }\n    }\n  })\n}\n\nexport const get = url => {\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest()\n    xhr.open('GET', url)\n    xhr.onreadystatechange = handleResponse\n    xhr.onerror = e => reject(e)\n    xhr.send()\n\n    function handleResponse () {\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200) {\n        var res = JSON.parse(xhr.responseText)\n        resolve(res)\n        } else {\n        reject(this.statusText)\n        }\n      }\n    }\n  })\n}\n\nexport const alert = (type, title, msg) => {\n  appEvents.emit('alert-' + type, [title, msg])\n}\n\nexport const showModal = (html, data) => {\n  appEvents.emit('show-modal', {\n    src: 'public/plugins/smart-factory-reason-codes-crud-tree-chart-panel/partials/' + html,\n    modalClass: 'confirm-modal',\n    model: data\n  })\n}\n\nexport const writeProductionLine = data => {\n    let postgresUrl = postgRestHost + 'equipment?site=eq.' + data.info.site\n    // + '&area=eq.' + rowData.Area + '&line=eq.' + rowData.Line\n    switch (data.type) {\n      case 'Site': break;\n      case 'Area': \n        postgresUrl += '&area=eq.' + data.info.area\n        break;\n      case 'Line': \n        postgresUrl += '&area=eq.' + data.info.area + '&production_line=eq.' + data.info.line\n        break;\n      default:\n        postgresUrl = null\n        break;\n    }\n    return postgresUrl\n  }\n\n  export const writeLine  = (data) => {\n    let postgresUrl = postgRestHost + 'reason_code?category_id=eq.' + data.info.category\n    // + '&area=eq.' + rowData.Area + '&line=eq.' + rowData.Line\n    switch (data.type) {\n      case 'Category': break;\n      case 'Parent Reason': \n        postgresUrl += '&reason_id=eq.' + data.info.reason + '&parent_reason_id=is.null'\n        break;\n      case 'Reason': \n        postgresUrl += '&reason_id=eq.' + data.info.reason + '&parent_reason_id=eq.' + data.parent\n        break;\n      default:\n        postgresUrl = null\n        break;\n    }\n    return postgresUrl\n  }\n\n  export const getReasons = (node, allData) => {\n    const category = node.info.category\n    let reasons = allData.filter(d => d.category_id === category && d.reason_id !== null).reduce((arr, d) => {\n      arr.push(d.reason_id)\n      return arr\n    }, [])\n    reasons = Array.from(new Set(reasons))\n    return reasons\n  }"]}